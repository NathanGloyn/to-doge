function List(a,b){function c(a){for(var b=0;b<a.length;b++){var c=JSON.parse(a[b],reviver);c.id>g&&(g=c.id),c.done?f.push(c):e.push(c)}g++}function d(a,b){for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c];return null}var e=[],f=[],g=0;this.storage=a,this.toDo=e,this.done=f,this.add=function(b){var c=new ListItemModel(g,b);return e.push(c),a.store(c.id,JSON.stringify(c)),g++,c},this.markDone=function(b){var c=new Date,g=d(b,e);return f.push(g),g.done=!0,g.dateDone=c,a.store(g.id,JSON.stringify(g)),g},this.loadItems=function(){var d=b.Deferred();return a.load().then(c).then(function(){d.resolve()}),d.promise()}}function ListItemModel(a,b){var c=new Date;this.id=a,this.text=b,this.done=!1,this.dateCreated=c,this.dateDone=null}function reviver(a,b){var c;return"string"==typeof b&&(c=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)(Z)$/.exec(b))?new Date(Date.UTC(+c[1],+c[2]-1,+c[3],+c[4],+c[5],+c[6])):b}function Storage(a){this.store=function(a,b){localStorage.setItem("to-doge\\"+a,b)},this.load=function(){for(var b=a.Deferred(),c=[],d=0;d<localStorage.length;d++){if(d>localStorage.length-1)return null;localStorage.key(d).indexOf("to-doge")&&c.push(localStorage.getItem(localStorage.key(d)))}return b.resolve(c).promise()}}function Doge(a){function b(){if(!g.length)return"wow";var a=Math.floor(Math.random()*g.length);return g[a]}function c(){var c=a(".text");c.length>50&&c[0].remove();var g=a("<div />").addClass("text");g.addClass(f[Math.floor(Math.random()*f.length)]),g.addClass(e[Math.floor(Math.random()*f.length)]),g.html(b());var h=550*Math.random()+d.left;h<d.left&&(h+=d.left);var i=600*Math.random()+d.top;g.css("left",h+"px"),g.css("top",i+"px"),g.hide(),a("#doge").append(g),g.fadeIn(600)}var d,e=["red","green","blue","yellow","magenta","cyan"],f=["small","medium","big"],g=["wow","much cool","lol"],h=0;this.display=function(){a("#doge").toggle(),d=a("#doge").position(),h=a("#doge").width();for(var b=0;50>b;b++)c()}}!function(a,b){function c(){s.loadItems().then(function(){for(var a=0;a<s.toDo.length;a++)j(s.toDo[a],u),r++;for(var c=0;c<s.done.length;c++)j(s.done[c],b("#doneList"))})}function d(){b("body").keypress(k),v.click(g),x.keyup(h),b("#btnAddNewItem").click(i),b("#doge").click(q)}function e(a){var b=a?"visible":"hidden";w.css("visibility",b)}function f(a){var c=b(a.target);if(c.is(":checked")){a.stopPropagation();var d=c.attr("id"),e=d.replace(/item-/gi,""),f=s.markDone(e);t.display(),setTimeout(function(){q(),o(f)},2e3)}}function g(){e(!0),v.hide(),x.focus()}function h(a){13==a.keyCode&&(i(),a.stopPropagation())}function i(){var a=x.val();if(a){var b=s.add(a);j(b,u),r++,l()}}function j(a,b){var c=a.done?n(a):m(a);b.append(c)}function k(a){27===a.keyCode&&(l(),a.preventDefault(),a.stopPropagation())}function l(){x.val(""),e(!1),v.show(),v.focus()}function m(c){var d=b(a.createElement("li")).append(b(a.createElement("input")).attr({id:"item-"+c.id,type:"checkbox"}).click(f)).append(b(a.createElement("label")).attr({"for":"item-"+c.id}).text(c.text));return d}function n(c){var d=b(a.createElement("li")).append(b(a.createElement("span")).text(c.text)).append(b(a.createElement("span")).text(c.dateDone.toLocaleString()).addClass("doneDate"));return d}function o(a){var c=b("label[for='item-"+a.id+"']").parent();c.remove();var d=n(a);b("#doneList").append(d)}function p(){b(".tabs .tab-links a").on("click",function(a){var c=b(this).attr("href");b(".tab"+c).show().siblings().hide(),b(this).parent("li").addClass("active").siblings().removeClass("active"),a.preventDefault()})}function q(){b("#doge div").remove(),b("#doge").toggle()}var r=0,s=new List(new Storage(b),b),t=new Doge(b),u=b("#toDoList"),v=b("#btnNewItem"),w=b("#newItemDiv"),x=b("#txtNewItem");b(a).ready(function(){b("#doge").toggle(),p(),d(),c()})}(window.document,window.jQuery);